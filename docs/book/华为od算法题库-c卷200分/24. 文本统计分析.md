# 24. 文本统计分析

![24](/images/od2/24.png)

```js
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
});

let input = '';
rl.on('line', (line) => {
    input += line + '\n';
});
rl.on('close', () => {
    console.log(countTexts(input));
})
function countTexts(input) {
    let count = 0;
    let inString = false;
    let inComment = false;
    let stringDelimiter = '';
    let isEmpty = true;
    for(let i=0; i<input.length; i++) {
        let c = input[i];
        let nextChart = (i + 1 < input.length) ? input[i+1] : '\0';
        if (inComment) {
            if (c === '\n') {
                inComment = false;
            }
            continue;
        }

        if (c==='-' && nextChar === '-' && !inString) {
            inComment = true;
            i++;
            continue;
        }

        if (c==='\'' || c === '\"' && !inString) {
            inString = true;
            stringDelimiter = c;
            isEmpty = false;
            continue;
        }
        if (c === stringDelimiter && inString) {
            if (nextChar === stringDelimiter) {
                i++;
            } else {
                inString = false;
            }
            continue;
        }
        if (c===';' && !inString) {
            if (!isEmpty) {
                count++;
                isEmpty = true;
            }
            continue;
        }
        if (!/\s/.test(c) && !inString) {
            isEmpty = false;
        }


    }
    if (!isEmpty) {
        count++;
    }
    return count;
}
```