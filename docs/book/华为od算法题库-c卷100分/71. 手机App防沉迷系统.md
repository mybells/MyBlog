# 71. 手机App防沉迷系统
![71](/images/od/71.png)
![71-1](/images/od/71-1.png)

```js
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
});

class App {
    constructor(name, priority, startTime, endTime) {
        this.name = name;
        this.priority = priority;
        this.startTime = startTime;
        this.endTime = endTime;
    }
}

const lines = [];
rl.on('line', function(line) {
    lines.push(line);
});
rl.on('close', () => {
    processInput(lines);
})

function processInput(lines) {
    const n = parseInt(lines.shift());
    const apps = [];

    for(let i=0; i<n; i++) {
        const [appName, appPriority, appStartTime, appEndTime] = lines.shift().split(' ');
        apps.push(new App(appName, parseInt(appPriority), converTime(appStartTime), converTime(appEndTime)));
    }

    const queryTime = convertTime(lines.shift());
    let appAtTime = "NA";
    const registeredApps = [];
    for(const app of apps) {
        if (app.startTime >= app.endTime) continue;

        for(let i=registeredApps.length-1; i>=0; i--) {
            const registered = registeredApps[i];
            // 存在时间冲突
            if (Math.max(app.startTime, registered.startTime) < Math.min(app.endTime, registered.endTime)) {
                if (app.priority > registered.priority) {
                    registeredApps.splice(i, 1);
                } else {
                    continue
                }
            }
        }
        registeredApps.push(app);
    }

    for(const app of registeredApps) {
        if (queryTime >= app.startTime && queryTime < app.endTime) {
            appAtTime = app.name;
            break;
        }
    }

    console.log(appATime);
}

function convertTime(time) {
    const [hours, minutes] = time.split(':').map(Number);
    return hours*60 + minutes;
}
```

